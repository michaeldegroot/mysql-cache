cache:
  directories:
    - $HOME/.node-gyp
    - $HOME/.npm
    - node_modules
before_install:
  - if [ $TRAVIS_OS_NAME == "linux" ]; then
      export CC="gcc-4.7";
      export CXX="g++-4.7";
      export LINK="gcc-4.7";
      export LINKXX="g++-4.7";
    fi
  - nvm --version
  - node --version
  - npm --version
  - gcc --version
  - g++ --version
addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
    packages:
      - gcc-4.7
      - g++-4.7
language: node_js
compiler: gcc
services:
  - mysql
node_js:
  - '7.4'
  - '7.0'
  - '6.0'
  - '5.0'
  - '4.0'
os:
  - linux
before_script:
  - export PATH=$PATH:/usr/local/mysql/bin
  - mysql -e 'create database mysqlcache;use mysqlcache;SET FOREIGN_KEY_CHECKS=0;DROP TABLE IF EXISTS `test`;CREATE TABLE `test` (`id` int(11) NOT NULL AUTO_INCREMENT,PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8;'
after_script: NODE_ENV=test istanbul cover ./node_modules/mocha/bin/_mocha -- -R spec ./test/* && node node_modules/coveralls/bin/coveralls.js < coverage/lcov.info
